name: Publish Extension
on:
    workflow_dispatch:
    # release:
    #   types: [published]

jobs:
    build-and-publish:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@3df4ab11eba7bda6032a0b82a6bb43b11571feac # v4
            # - name: Create .env file
            #   uses: SpicyPizza/create-envfile@v1.3.1
            #   with:
            #       envkey_CREDENTIALS: ${{ secrets.CREDENTIALS }}
            - name: Setup pnpm
              uses: pnpm/action-setup@v2.4.0
              with:
                  version: latest
            - name: Install deps
              run: pnpm i --frozen-lockfile
            - name: Build extension
              run: pnpm run build
            - name: Publish extension with Plasmo
              uses: PlasmoHQ/bpp@v2
              with:
                  keys: ${{ secrets.BPP_KEYS }}
